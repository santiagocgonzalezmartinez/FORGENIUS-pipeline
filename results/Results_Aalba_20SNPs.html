<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"><head>

<meta charset="utf-8">
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta name="generator" content="pandoc">
<meta name="viewport" content="width=device-width, initial-scale=1">

<style type="text/css">
@font-face {
font-family: octicons-link;
src: url(data:font/woff;charset=utf-8;base64,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) format('woff');
}
body {
-webkit-text-size-adjust: 100%;
text-size-adjust: 100%;
color: #333;
font-family: "Helvetica Neue", Helvetica, "Segoe UI", Arial, freesans, sans-serif, "Apple Color Emoji", "Segoe UI Emoji", "Segoe UI Symbol";
font-size: 16px;
line-height: 1.6;
word-wrap: break-word;
}
a {
background-color: transparent;
}
a:active,
a:hover {
outline: 0;
}
strong {
font-weight: bold;
}
h1 {
font-size: 2em;
margin: 0.67em 0;
}
img {
border: 0;
}
hr {
box-sizing: content-box;
height: 0;
}
pre {
overflow: auto;
}
code,
kbd,
pre {
font-family: monospace, monospace;
font-size: 1em;
}
input {
color: inherit;
font: inherit;
margin: 0;
}
html input[disabled] {
cursor: default;
}
input {
line-height: normal;
}
input[type="checkbox"] {
box-sizing: border-box;
padding: 0;
}
table {
border-collapse: collapse;
border-spacing: 0;
}
td,
th {
padding: 0;
}
* {
box-sizing: border-box;
}
input {
font: 13px / 1.4 Helvetica, arial, nimbussansl, liberationsans, freesans, clean, sans-serif, "Apple Color Emoji", "Segoe UI Emoji", "Segoe UI Symbol";
}
a {
color: #4078c0;
text-decoration: none;
}
a:hover,
a:active {
text-decoration: underline;
}
hr {
height: 0;
margin: 15px 0;
overflow: hidden;
background: transparent;
border: 0;
border-bottom: 1px solid #ddd;
}
hr:before {
display: table;
content: "";
}
hr:after {
display: table;
clear: both;
content: "";
}
h1,
h2,
h3,
h4,
h5,
h6 {
margin-top: 15px;
margin-bottom: 15px;
line-height: 1.1;
}
h1 {
font-size: 30px;
}
h2 {
font-size: 21px;
}
h3 {
font-size: 16px;
}
h4 {
font-size: 14px;
}
h5 {
font-size: 12px;
}
h6 {
font-size: 11px;
}
blockquote {
margin: 0;
}
ul,
ol {
padding: 0;
margin-top: 0;
margin-bottom: 0;
}
ol ol,
ul ol {
list-style-type: lower-roman;
}
ul ul ol,
ul ol ol,
ol ul ol,
ol ol ol {
list-style-type: lower-alpha;
}
dd {
margin-left: 0;
}
code {
font-family: Consolas, "Liberation Mono", Menlo, Courier, monospace;
font-size: 12px;
}
pre {
margin-top: 0;
margin-bottom: 0;
font: 12px Consolas, "Liberation Mono", Menlo, Courier, monospace;
}
.select::-ms-expand {
opacity: 0;
}
.octicon {
font: normal normal normal 16px/1 octicons-link;
display: inline-block;
text-decoration: none;
text-rendering: auto;
-webkit-font-smoothing: antialiased;
-moz-osx-font-smoothing: grayscale;
-webkit-user-select: none;
-moz-user-select: none;
-ms-user-select: none;
user-select: none;
}
.octicon-link:before {
content: '\f05c';
}
.markdown-body:before {
display: table;
content: "";
}
.markdown-body:after {
display: table;
clear: both;
content: "";
}
.markdown-body>*:first-child {
margin-top: 0 !important;
}
.markdown-body>*:last-child {
margin-bottom: 0 !important;
}
a:not([href]) {
color: inherit;
text-decoration: none;
}
.anchor {
display: inline-block;
padding-right: 2px;
margin-left: -18px;
}
.anchor:focus {
outline: none;
}
h1,
h2,
h3,
h4,
h5,
h6 {
margin-top: 1em;
margin-bottom: 16px;
font-weight: bold;
line-height: 1.4;
}
h1 .octicon-link,
h2 .octicon-link,
h3 .octicon-link,
h4 .octicon-link,
h5 .octicon-link,
h6 .octicon-link {
color: #000;
vertical-align: middle;
visibility: hidden;
}
h1:hover .anchor,
h2:hover .anchor,
h3:hover .anchor,
h4:hover .anchor,
h5:hover .anchor,
h6:hover .anchor {
text-decoration: none;
}
h1:hover .anchor .octicon-link,
h2:hover .anchor .octicon-link,
h3:hover .anchor .octicon-link,
h4:hover .anchor .octicon-link,
h5:hover .anchor .octicon-link,
h6:hover .anchor .octicon-link {
visibility: visible;
}
h1 {
padding-bottom: 0.3em;
font-size: 2.25em;
line-height: 1.2;
border-bottom: 1px solid #eee;
}
h1 .anchor {
line-height: 1;
}
h2 {
padding-bottom: 0.3em;
font-size: 1.75em;
line-height: 1.225;
border-bottom: 1px solid #eee;
}
h2 .anchor {
line-height: 1;
}
h3 {
font-size: 1.5em;
line-height: 1.43;
}
h3 .anchor {
line-height: 1.2;
}
h4 {
font-size: 1.25em;
}
h4 .anchor {
line-height: 1.2;
}
h5 {
font-size: 1em;
}
h5 .anchor {
line-height: 1.1;
}
h6 {
font-size: 1em;
color: #777;
}
h6 .anchor {
line-height: 1.1;
}
p,
blockquote,
ul,
ol,
dl,
table,
pre {
margin-top: 0;
margin-bottom: 16px;
}
hr {
height: 4px;
padding: 0;
margin: 16px 0;
background-color: #e7e7e7;
border: 0 none;
}
ul,
ol {
padding-left: 2em;
}
ul ul,
ul ol,
ol ol,
ol ul {
margin-top: 0;
margin-bottom: 0;
}
li>p {
margin-top: 16px;
}
dl {
padding: 0;
}
dl dt {
padding: 0;
margin-top: 16px;
font-size: 1em;
font-style: italic;
font-weight: bold;
}
dl dd {
padding: 0 16px;
margin-bottom: 16px;
}
blockquote {
padding: 0 15px;
color: #777;
border-left: 4px solid #ddd;
}
blockquote>:first-child {
margin-top: 0;
}
blockquote>:last-child {
margin-bottom: 0;
}
table {
display: block;
width: 100%;
overflow: auto;
word-break: normal;
word-break: keep-all;
}
table th {
font-weight: bold;
}
table th,
table td {
padding: 6px 13px;
border: 1px solid #ddd;
}
table tr {
background-color: #fff;
border-top: 1px solid #ccc;
}
table tr:nth-child(2n) {
background-color: #f8f8f8;
}
img {
max-width: 100%;
box-sizing: content-box;
background-color: #fff;
}
code {
padding: 0;
padding-top: 0.2em;
padding-bottom: 0.2em;
margin: 0;
font-size: 85%;
background-color: rgba(0,0,0,0.04);
border-radius: 3px;
}
code:before,
code:after {
letter-spacing: -0.2em;
content: "\00a0";
}
pre>code {
padding: 0;
margin: 0;
font-size: 100%;
word-break: normal;
white-space: pre;
background: transparent;
border: 0;
}
.highlight {
margin-bottom: 16px;
}
.highlight pre,
pre {
padding: 16px;
overflow: auto;
font-size: 85%;
line-height: 1.45;
background-color: #f7f7f7;
border-radius: 3px;
}
.highlight pre {
margin-bottom: 0;
word-break: normal;
}
pre {
word-wrap: normal;
}
pre code {
display: inline;
max-width: initial;
padding: 0;
margin: 0;
overflow: initial;
line-height: inherit;
word-wrap: normal;
background-color: transparent;
border: 0;
}
pre code:before,
pre code:after {
content: normal;
}
kbd {
display: inline-block;
padding: 3px 5px;
font-size: 11px;
line-height: 10px;
color: #555;
vertical-align: middle;
background-color: #fcfcfc;
border: solid 1px #ccc;
border-bottom-color: #bbb;
border-radius: 3px;
box-shadow: inset 0 -1px 0 #bbb;
}
.pl-c {
color: #969896;
}
.pl-c1,
.pl-s .pl-v {
color: #0086b3;
}
.pl-e,
.pl-en {
color: #795da3;
}
.pl-s .pl-s1,
.pl-smi {
color: #333;
}
.pl-ent {
color: #63a35c;
}
.pl-k {
color: #a71d5d;
}
.pl-pds,
.pl-s,
.pl-s .pl-pse .pl-s1,
.pl-sr,
.pl-sr .pl-cce,
.pl-sr .pl-sra,
.pl-sr .pl-sre {
color: #183691;
}
.pl-v {
color: #ed6a43;
}
.pl-id {
color: #b52a1d;
}
.pl-ii {
background-color: #b52a1d;
color: #f8f8f8;
}
.pl-sr .pl-cce {
color: #63a35c;
font-weight: bold;
}
.pl-ml {
color: #693a17;
}
.pl-mh,
.pl-mh .pl-en,
.pl-ms {
color: #1d3e81;
font-weight: bold;
}
.pl-mq {
color: #008080;
}
.pl-mi {
color: #333;
font-style: italic;
}
.pl-mb {
color: #333;
font-weight: bold;
}
.pl-md {
background-color: #ffecec;
color: #bd2c00;
}
.pl-mi1 {
background-color: #eaffea;
color: #55a532;
}
.pl-mdr {
color: #795da3;
font-weight: bold;
}
.pl-mo {
color: #1d3e81;
}
kbd {
display: inline-block;
padding: 3px 5px;
font: 11px Consolas, "Liberation Mono", Menlo, Courier, monospace;
line-height: 10px;
color: #555;
vertical-align: middle;
background-color: #fcfcfc;
border: solid 1px #ccc;
border-bottom-color: #bbb;
border-radius: 3px;
box-shadow: inset 0 -1px 0 #bbb;
}
.task-list-item {
list-style-type: none;
}
.task-list-item+.task-list-item {
margin-top: 3px;
}
.task-list-item input {
margin: 0 0.35em 0.25em -1.6em;
vertical-align: middle;
}
:checked+.radio-label {
z-index: 1;
position: relative;
border-color: #4078c0;
}
.sourceLine {
display: inline-block;
}
code .kw { color: #000000; }
code .dt { color: #ed6a43; }
code .dv { color: #009999; }
code .bn { color: #009999; }
code .fl { color: #009999; }
code .ch { color: #009999; }
code .st { color: #183691; }
code .co { color: #969896; }
code .ot { color: #0086b3; }
code .al { color: #a61717; }
code .fu { color: #63a35c; }
code .er { color: #a61717; background-color: #e3d2d2; }
code .wa { color: #000000; }
code .cn { color: #008080; }
code .sc { color: #008080; }
code .vs { color: #183691; }
code .ss { color: #183691; }
code .im { color: #000000; }
code .va {color: #008080; }
code .cf { color: #000000; }
code .op { color: #000000; }
code .bu { color: #000000; }
code .ex { color: #000000; }
code .pp { color: #999999; }
code .at { color: #008080; }
code .do { color: #969896; }
code .an { color: #008080; }
code .cv { color: #008080; }
code .in { color: #008080; }
</style>
<style>
body {
box-sizing: border-box;
min-width: 200px;
max-width: 980px;
margin: 0 auto;
padding: 45px;
padding-top: 0px;
}
</style>


</head>

<body>

<h1 id="forgenius-pipeline-test-20-snps">FORGENIUS-pipeline, test 20
SNPs</h1>
<p>SCGM &amp; MW 2024-04-02</p>
<p>Load packages</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" tabindex="-1"></a><span class="fu">rm</span>(<span class="at">list =</span> <span class="fu">ls</span>()) <span class="co"># cleans the working environment</span></span>
<span id="cb1-2"><a href="#cb1-2" tabindex="-1"></a></span>
<span id="cb1-3"><a href="#cb1-3" tabindex="-1"></a><span class="co">#IMPORTANT: don't change order of libraries as some mask others!</span></span>
<span id="cb1-4"><a href="#cb1-4" tabindex="-1"></a><span class="fu">library</span>(vcfR)</span>
<span id="cb1-5"><a href="#cb1-5" tabindex="-1"></a><span class="fu">library</span>(adegenet)</span>
<span id="cb1-6"><a href="#cb1-6" tabindex="-1"></a><span class="co">#library(genepop)</span></span>
<span id="cb1-7"><a href="#cb1-7" tabindex="-1"></a><span class="fu">library</span>(graph4lg)</span>
<span id="cb1-8"><a href="#cb1-8" tabindex="-1"></a><span class="fu">library</span>(hierfstat)</span>
<span id="cb1-9"><a href="#cb1-9" tabindex="-1"></a><span class="co">#library(radiator)</span></span>
<span id="cb1-10"><a href="#cb1-10" tabindex="-1"></a><span class="co">#library(VariantAnnotation)</span></span>
<span id="cb1-11"><a href="#cb1-11" tabindex="-1"></a><span class="co">#library(genomation)</span></span>
<span id="cb1-12"><a href="#cb1-12" tabindex="-1"></a><span class="co">#library(pegas)</span></span>
<span id="cb1-13"><a href="#cb1-13" tabindex="-1"></a><span class="co">#library(GenomicRanges)</span></span>
<span id="cb1-14"><a href="#cb1-14" tabindex="-1"></a><span class="fu">library</span>(LEA)</span>
<span id="cb1-15"><a href="#cb1-15" tabindex="-1"></a><span class="fu">library</span>(rnaturalearth)</span>
<span id="cb1-16"><a href="#cb1-16" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb1-17"><a href="#cb1-17" tabindex="-1"></a><span class="fu">library</span>(mapplots)</span>
<span id="cb1-18"><a href="#cb1-18" tabindex="-1"></a><span class="fu">library</span>(shapefiles)</span></code></pre></div>
<p>Read data and convert to different formats</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" tabindex="-1"></a>data_vcf <span class="ot">&lt;-</span> <span class="fu">read.vcfR</span>(<span class="st">"data/Aalba_20SNPs.vcf.gz"</span>) <span class="co">#change species name</span></span></code></pre></div>
<pre><code>## Scanning file to determine attributes.
## File attributes:
##   meta lines: 7577
##   header_line: 7578
##   variant count: 20
##   column count: 422
## Meta line 1000 read in.Meta line 2000 read in.Meta line 3000 read in.Meta line 4000 read in.Meta line 5000 read in.Meta line 6000 read in.Meta line 7000 read in.Meta line 7577 read in.
## All meta lines processed.
## gt matrix initialized.
## Character matrix gt created.
##   Character matrix gt rows: 20
##   Character matrix gt cols: 422
##   skip: 0
##   nrows: 20
##   row_num: 0
## Processed variant: 20
## All variants processed</code></pre>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" tabindex="-1"></a><span class="co"># subset VCF files based on bed file - do it in vcftools!</span></span>
<span id="cb4-2"><a href="#cb4-2" tabindex="-1"></a></span>
<span id="cb4-3"><a href="#cb4-3" tabindex="-1"></a><span class="co"># adegenet formats (genind and genpop)</span></span>
<span id="cb4-4"><a href="#cb4-4" tabindex="-1"></a>data_genind <span class="ot">&lt;-</span> <span class="fu">vcfR2genind</span>(data_vcf)</span>
<span id="cb4-5"><a href="#cb4-5" tabindex="-1"></a><span class="fu">pop</span>(data_genind) <span class="ot">&lt;-</span> <span class="fu">substr</span>(<span class="fu">indNames</span>(data_genind), <span class="dv">1</span>,<span class="dv">8</span>) <span class="co">#takes pop name from the first 8 digits of sample name, e.g. AUT00215</span></span>
<span id="cb4-6"><a href="#cb4-6" tabindex="-1"></a>individual_names<span class="ot">&lt;-</span><span class="fu">indNames</span>(data_genind) <span class="co">#extract individual names</span></span>
<span id="cb4-7"><a href="#cb4-7" tabindex="-1"></a>data_genpop <span class="ot">&lt;-</span> <span class="fu">genind2genpop</span>(data_genind)</span></code></pre></div>
<pre><code>## 
##  Converting data from a genind to a genpop object... 
## 
## ...done.</code></pre>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" tabindex="-1"></a><span class="fu">print</span>(data_genpop)</span></code></pre></div>
<pre><code>## /// GENPOP OBJECT /////////
## 
##  // 18 populations; 20 loci; 40 alleles; size: 19.7 Kb
## 
##  // Basic content
##    @tab:  18 x 40 matrix of allele counts
##    @loc.n.all: number of alleles per locus (range: 2-2)
##    @loc.fac: locus factor for the 40 columns of @tab
##    @all.names: list of allele names for each locus
##    @ploidy: ploidy of each individual  (range: 2-2)
##    @type:  codom
##    @call: genind2genpop(x = data_genind)
## 
##  // Optional content
##    - empty -</code></pre>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" tabindex="-1"></a>pop_names<span class="ot">&lt;-</span><span class="fu">popNames</span>(data_genpop)</span>
<span id="cb8-2"><a href="#cb8-2" tabindex="-1"></a></span>
<span id="cb8-3"><a href="#cb8-3" tabindex="-1"></a><span class="co"># counting individuals per population</span></span>
<span id="cb8-4"><a href="#cb8-4" tabindex="-1"></a>pop_labels <span class="ot">&lt;-</span> data_genind<span class="sc">@</span>pop</span>
<span id="cb8-5"><a href="#cb8-5" tabindex="-1"></a>individuals_per_pop <span class="ot">&lt;-</span> <span class="fu">table</span>(pop_labels)</span>
<span id="cb8-6"><a href="#cb8-6" tabindex="-1"></a></span>
<span id="cb8-7"><a href="#cb8-7" tabindex="-1"></a><span class="co"># hierfstat format</span></span>
<span id="cb8-8"><a href="#cb8-8" tabindex="-1"></a>data_hierfstat <span class="ot">&lt;-</span> <span class="fu">genind2hierfstat</span>(data_genind,<span class="at">pop=</span><span class="cn">NULL</span>)</span>
<span id="cb8-9"><a href="#cb8-9" tabindex="-1"></a></span>
<span id="cb8-10"><a href="#cb8-10" tabindex="-1"></a><span class="co"># bayescan format to external file</span></span>
<span id="cb8-11"><a href="#cb8-11" tabindex="-1"></a><span class="fu">write.bayescan</span>(<span class="at">dat=</span>data_hierfstat,<span class="at">diploid=</span><span class="cn">TRUE</span>,<span class="at">fn=</span><span class="st">"data_bayescan"</span>) <span class="co">#writting this file can take about 6 hours for 90k SNPs; better to store these files once generated!</span></span>
<span id="cb8-12"><a href="#cb8-12" tabindex="-1"></a></span>
<span id="cb8-13"><a href="#cb8-13" tabindex="-1"></a><span class="co"># structure format to external file</span></span>
<span id="cb8-14"><a href="#cb8-14" tabindex="-1"></a><span class="fu">write.struct</span>(<span class="at">dat=</span>data_hierfstat,<span class="at">ilab=</span>individual_names,<span class="at">pop=</span><span class="cn">NULL</span>,<span class="at">MARKERNAMES=</span><span class="cn">FALSE</span>,<span class="at">MISSING=</span><span class="sc">-</span><span class="dv">9</span>,<span class="at">fname=</span><span class="st">"data_structure"</span>) </span>
<span id="cb8-15"><a href="#cb8-15" tabindex="-1"></a></span>
<span id="cb8-16"><a href="#cb8-16" tabindex="-1"></a><span class="co"># geno format to external file</span></span>
<span id="cb8-17"><a href="#cb8-17" tabindex="-1"></a><span class="fu">struct2geno</span> (<span class="at">input.file=</span><span class="st">"data_structure"</span>, <span class="at">ploidy=</span><span class="dv">2</span>, <span class="at">FORMAT=</span><span class="dv">2</span>, <span class="at">extra.row=</span><span class="dv">0</span>, <span class="at">extra.column=</span><span class="dv">1</span>) <span class="co">#writting this file can also take quite long</span></span></code></pre></div>
<pre><code>## Input file in the STRUCTURE format. The genotypic matrix has 413 individuals and 20 markers. 
## The number of extra rows is 0 and the number of extra columns is 1 .
## Missing alleles are encoded as -9 , converted as 9.
## Output files: data_structure.geno  .lfmm.</code></pre>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" tabindex="-1"></a><span class="co"># genepop format to external file</span></span>
<span id="cb10-2"><a href="#cb10-2" tabindex="-1"></a><span class="co">#genind_to_genepop(data_genind, output = "data_genepop.txt")</span></span></code></pre></div>
<p>Run admixture analysis with LEA</p>
<p>Estimate admixture coefficients</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" tabindex="-1"></a><span class="co"># processing sNMF results</span></span>
<span id="cb11-2"><a href="#cb11-2" tabindex="-1"></a><span class="fu">plot</span>(data_snmf, <span class="at">cex =</span> <span class="fl">1.2</span>, <span class="at">col =</span> <span class="st">"lightblue"</span>, <span class="at">pch =</span> <span class="dv">19</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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"><!-- --></p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" tabindex="-1"></a>best_K <span class="ot">=</span> <span class="dv">5</span>  <span class="co">#select best K based on entropy graph</span></span>
<span id="cb12-2"><a href="#cb12-2" tabindex="-1"></a>ce <span class="ot">&lt;-</span>  <span class="fu">cross.entropy</span>(data_snmf, <span class="at">K =</span> best_K)</span>
<span id="cb12-3"><a href="#cb12-3" tabindex="-1"></a>best_run <span class="ot">&lt;-</span> <span class="fu">which.min</span>(ce)</span>
<span id="cb12-4"><a href="#cb12-4" tabindex="-1"></a></span>
<span id="cb12-5"><a href="#cb12-5" tabindex="-1"></a><span class="co"># plot barchart for best run of best K</span></span>
<span id="cb12-6"><a href="#cb12-6" tabindex="-1"></a><span class="fu">barchart</span> (data_snmf, best_K, best_run, <span class="at">sort.by.Q =</span> T, <span class="at">col =</span> <span class="fu">rainbow</span>(best_K),<span class="at">border =</span> <span class="cn">NA</span>, <span class="at">space =</span> <span class="dv">0</span>, <span class="at">xlab =</span> <span class="st">"Individuals"</span>, <span class="at">ylab =</span> <span class="st">"Admixture coefficients"</span>) <span class="co">#use "sort.by.Q = F, names.arg= individual_names, cex.names = 0.4, las=2, " to get ind labels in original order</span></span></code></pre></div>
<p><img src="data:image/png;base64,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"><!-- --></p>
<pre><code>## $order
##   [1]  14  16  79  83 143 206 208 211 212 269 270 273 274 275 279 281 285 288
##  [19] 318 320 338 350 355 381   4   5  10  13  22  27  28  33  40  46  47  52
##  [37]  61  64  68  71  73  85  86  99 100 101 102 103 105 122 132 157 167 170
##  [55] 172 174 176 181 182 187 192 193 207 209 218 229 230 271 278 280 287 291
##  [73] 292 296 305 307 319 325 331 340 363 366 371 372 373 382 401 404 412   1
##  [91]   2   6   7   8   9  12  15  17  18  20  21  25  26  29  31  35  36  39
## [109]  41  42  43  44  45  48  49  50  51  53  55  57  58  66  67  75  77  78
## [127]  81  87  89  90  91  92  93  94  95  96  97  98 104 106 107 108 109 110
## [145] 111 112 113 115 116 117 118 120 121 123 124 125 126 127 128 129 131 133
## [163] 134 135 137 140 141 144 145 146 147 148 149 150 151 152 153 155 156 158
## [181] 159 160 161 162 163 166 168 169 173 175 177 178 179 183 184 185 186 197
## [199] 199 201 203 204 205 213 215 216 217 219 220 221 222 223 225 226 227 228
## [217] 231 232 233 234 235 236 237 239 244 245 247 253 262 268 272 277 283 284
## [235] 295 297 304 306 312 314 316 321 333 335 337 347 356 358 362 365 368 375
## [253] 379 383 388 389 390 393 395 402   3  11  19  23  37  38  56  59  65  69
## [271]  70  72  74  76  80  82  84  88 139 171 190 191 194 200 210 224 238 242
## [289] 243 246 248 250 254 256 259 261 267 276 282 289 290 294 298 300 303 308
## [307] 309 317 328 334 339 343 345 346 349 352 353 361 367 369 378 384 386 392
## [325] 398 399 407 408 409  24  30  32  34  54  60  62  63 114 119 130 136 138
## [343] 142 154 164 165 180 188 189 195 196 198 202 214 240 241 249 251 252 255
## [361] 257 258 260 263 264 265 266 286 293 299 301 302 310 311 313 315 322 323
## [379] 324 326 327 329 330 332 336 341 342 344 348 351 354 357 359 360 364 370
## [397] 374 376 377 380 385 387 391 394 396 397 400 403 405 406 410 411 413</code></pre>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" tabindex="-1"></a><span class="co"># estimate ancestry coefficients by pop</span></span>
<span id="cb14-2"><a href="#cb14-2" tabindex="-1"></a>q_mat <span class="ot">&lt;-</span> LEA<span class="sc">::</span><span class="fu">Q</span>(data_snmf, <span class="at">K =</span> best_K, <span class="at">run =</span> best_run) </span>
<span id="cb14-3"><a href="#cb14-3" tabindex="-1"></a><span class="fu">colnames</span>(q_mat) <span class="ot">&lt;-</span> <span class="fu">paste0</span>(<span class="st">"Q"</span>, <span class="dv">1</span><span class="sc">:</span>best_K)</span>
<span id="cb14-4"><a href="#cb14-4" tabindex="-1"></a>q_matrix <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="fu">unlist</span>(q_mat))</span>
<span id="cb14-5"><a href="#cb14-5" tabindex="-1"></a>q_matrix <span class="ot">&lt;-</span> q_matrix <span class="sc">%&gt;%</span></span>
<span id="cb14-6"><a href="#cb14-6" tabindex="-1"></a>  <span class="fu">mutate</span>(individual_names, pop_labels)</span>
<span id="cb14-7"><a href="#cb14-7" tabindex="-1"></a>q_by_pop <span class="ot">&lt;-</span> <span class="fu">aggregate</span>(q_matrix[, <span class="dv">1</span><span class="sc">:</span>best_K], <span class="fu">list</span>(q_matrix<span class="sc">$</span>pop_labels), mean)</span>
<span id="cb14-8"><a href="#cb14-8" tabindex="-1"></a></span>
<span id="cb14-9"><a href="#cb14-9" tabindex="-1"></a><span class="co"># plot map for best K</span></span>
<span id="cb14-10"><a href="#cb14-10" tabindex="-1"></a>coord <span class="ot">=</span> <span class="fu">read.table</span>(<span class="st">"data/Aalba_coord.txt"</span>, <span class="at">header =</span> T) <span class="co">#change species name; GCU, longitude and latitude in this order</span></span>
<span id="cb14-11"><a href="#cb14-11" tabindex="-1"></a>Npop <span class="ot">=</span> <span class="fu">length</span>(<span class="fu">unique</span>(pop_names))</span>
<span id="cb14-12"><a href="#cb14-12" tabindex="-1"></a>qmatrix2plot <span class="ot">&lt;-</span> <span class="fu">merge</span>(coord, q_by_pop, <span class="at">by.x =</span> <span class="st">"GCU"</span>, <span class="at">by.y =</span> <span class="st">"Group.1"</span>)</span>
<span id="cb14-13"><a href="#cb14-13" tabindex="-1"></a>xlim <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">10</span>,<span class="dv">30</span>) </span>
<span id="cb14-14"><a href="#cb14-14" tabindex="-1"></a>ylim <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">35</span>,<span class="dv">55</span>)  <span class="co">#adjust if needed</span></span>
<span id="cb14-15"><a href="#cb14-15" tabindex="-1"></a><span class="fu">basemap</span>(xlim, ylim) </span>
<span id="cb14-16"><a href="#cb14-16" tabindex="-1"></a><span class="co">#shape &lt;- read.shapefile("shapefiles/chorological_maps_dataset/Abies_alba_syn_plg_clip") #change species name</span></span>
<span id="cb14-17"><a href="#cb14-17" tabindex="-1"></a>shape <span class="ot">&lt;-</span> <span class="fu">read.shapefile</span>(<span class="st">"shapefiles/Europe_merged"</span>)</span>
<span id="cb14-18"><a href="#cb14-18" tabindex="-1"></a><span class="fu">draw.shape</span>(shape, <span class="at">col =</span> <span class="st">"grey90"</span>)</span>
<span id="cb14-19"><a href="#cb14-19" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>Npop){</span>
<span id="cb14-20"><a href="#cb14-20" tabindex="-1"></a>  z_var<span class="ot">=</span><span class="cn">NULL</span></span>
<span id="cb14-21"><a href="#cb14-21" tabindex="-1"></a>  <span class="cf">for</span> (j <span class="cf">in</span> <span class="dv">4</span><span class="sc">:</span>(best_K<span class="sc">+</span><span class="dv">3</span>)){z_var <span class="ot">&lt;-</span> <span class="fu">append</span>(z_var, qmatrix2plot[i,j])}</span>
<span id="cb14-22"><a href="#cb14-22" tabindex="-1"></a>  <span class="fu">add.pie</span>(<span class="at">z =</span> z_var, <span class="at">x =</span> qmatrix2plot[i,<span class="dv">2</span>], <span class="at">y =</span> qmatrix2plot[i,<span class="dv">3</span>], <span class="at">labels =</span>   <span class="st">""</span>, <span class="at">col =</span> <span class="fu">rainbow</span>(best_K))</span>
<span id="cb14-23"><a href="#cb14-23" tabindex="-1"></a> }</span></code></pre></div>
<p><img src="data:image/png;base64,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"><!-- --></p>
<p>Compute number of polymorphic loci per population</p>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" tabindex="-1"></a><span class="co"># Estimate allele frequency in adegenet</span></span>
<span id="cb15-2"><a href="#cb15-2" tabindex="-1"></a>allele_freq <span class="ot">&lt;-</span> <span class="fu">tab</span>(data_genpop)</span>
<span id="cb15-3"><a href="#cb15-3" tabindex="-1"></a></span>
<span id="cb15-4"><a href="#cb15-4" tabindex="-1"></a><span class="co"># Count monomorphic loci and missing loci per population</span></span>
<span id="cb15-5"><a href="#cb15-5" tabindex="-1"></a>monomorphic_counts <span class="ot">&lt;-</span> <span class="fu">rowSums</span>(allele_freq <span class="sc">==</span> <span class="dv">1</span>)</span>
<span id="cb15-6"><a href="#cb15-6" tabindex="-1"></a>nb_loci <span class="ot">&lt;-</span> <span class="fu">rowSums</span>(allele_freq <span class="sc">!=</span> <span class="st">"NA"</span>)<span class="sc">/</span><span class="dv">2</span></span>
<span id="cb15-7"><a href="#cb15-7" tabindex="-1"></a>polymoprhic_loci <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">-</span>(monomorphic_counts<span class="sc">/</span>nb_loci)</span></code></pre></div>
<p>Compute basic stats with hierfstat</p>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" tabindex="-1"></a>Hs <span class="ot">&lt;-</span> <span class="fu">Hs</span>(data_hierfstat)</span>
<span id="cb16-2"><a href="#cb16-2" tabindex="-1"></a>Ho <span class="ot">&lt;-</span> <span class="fu">Ho</span>(data_hierfstat)</span>
<span id="cb16-3"><a href="#cb16-3" tabindex="-1"></a>Fis <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">-</span>(Ho<span class="sc">/</span>Hs)</span></code></pre></div>
<p>Compute genetic distinctness</p>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" tabindex="-1"></a><span class="co"># Average pairwise Fst</span></span>
<span id="cb17-2"><a href="#cb17-2" tabindex="-1"></a>pairwise_WCfst <span class="ot">&lt;-</span> <span class="fu">pairwise.WCfst</span>(data_hierfstat) <span class="co">#this is very slow, took about 16 hours for 15 pops and 90k SNPs in a laptop</span></span>
<span id="cb17-3"><a href="#cb17-3" tabindex="-1"></a>ave_pairwise_fst<span class="ot">&lt;-</span><span class="fu">rowMeans</span>(pairwise_WCfst, <span class="at">na.rm =</span> <span class="cn">TRUE</span>) </span>
<span id="cb17-4"><a href="#cb17-4" tabindex="-1"></a></span>
<span id="cb17-5"><a href="#cb17-5" tabindex="-1"></a><span class="co"># Population-specific Fst from bayescan</span></span>
<span id="cb17-6"><a href="#cb17-6" tabindex="-1"></a></span>
<span id="cb17-7"><a href="#cb17-7" tabindex="-1"></a><span class="co">#If you are running RStudio in Windows 10</span></span>
<span id="cb17-8"><a href="#cb17-8" tabindex="-1"></a><span class="fu">system2</span>(<span class="st">"powershell"</span>, <span class="at">arg =</span> <span class="fu">c</span>(<span class="st">"-file"</span>, <span class="st">"bayescan.ps1"</span>)) <span class="co">#check out running parameters in ps1 file; bayescan is very slow, took about 5 hours for 15 pops and 14k SNPs using 12 CPUs and standard parameters</span></span>
<span id="cb17-9"><a href="#cb17-9" tabindex="-1"></a><span class="fu">source</span> (<span class="st">"bayescan/plot_R.r"</span>)</span>
<span id="cb17-10"><a href="#cb17-10" tabindex="-1"></a><span class="fu">plot_bayescan</span>(<span class="st">"bayescan_results/data_bayescan_fst.txt"</span>,<span class="at">add_text=</span>T,<span class="at">pos=</span><span class="fl">0.02</span>,<span class="at">size=</span><span class="fl">0.7</span>,<span class="at">FDR=</span><span class="fl">0.05</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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"><!-- --></p>
<pre><code>## $outliers
## integer(0)
## 
## $nb_outliers
## [1] 0</code></pre>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" tabindex="-1"></a>output_bayescan<span class="ot">&lt;-</span><span class="fu">read.table</span>(<span class="st">"bayescan_results/data_bayescan.sel"</span>)</span>
<span id="cb19-2"><a href="#cb19-2" tabindex="-1"></a>output_bayescan<span class="sc">$</span>logL<span class="ot">&lt;-</span><span class="cn">NULL</span></span>
<span id="cb19-3"><a href="#cb19-3" tabindex="-1"></a>pop_specific_fst<span class="ot">&lt;-</span><span class="fu">colMeans</span>(output_bayescan, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb19-4"><a href="#cb19-4" tabindex="-1"></a></span>
<span id="cb19-5"><a href="#cb19-5" tabindex="-1"></a><span class="co">#If you are running RStudio in Linux - not tested yet!</span></span>
<span id="cb19-6"><a href="#cb19-6" tabindex="-1"></a><span class="co">#scan.pops &lt;- radiator::run_bayescan(</span></span>
<span id="cb19-7"><a href="#cb19-7" tabindex="-1"></a><span class="co">#    data = "data_bayescan",</span></span>
<span id="cb19-8"><a href="#cb19-8" tabindex="-1"></a><span class="co">#    n = 5000,</span></span>
<span id="cb19-9"><a href="#cb19-9" tabindex="-1"></a><span class="co">#    thin = 10,</span></span>
<span id="cb19-10"><a href="#cb19-10" tabindex="-1"></a><span class="co">#    nbp = 20,</span></span>
<span id="cb19-11"><a href="#cb19-11" tabindex="-1"></a><span class="co">#    pilot = 5000,</span></span>
<span id="cb19-12"><a href="#cb19-12" tabindex="-1"></a><span class="co">#    burn = 50000,</span></span>
<span id="cb19-13"><a href="#cb19-13" tabindex="-1"></a><span class="co">#    subsample = NULL,</span></span>
<span id="cb19-14"><a href="#cb19-14" tabindex="-1"></a><span class="co">#    iteration.subsample = 1,</span></span>
<span id="cb19-15"><a href="#cb19-15" tabindex="-1"></a><span class="co">#    parallel.core = parallel::detectCores() - 1,</span></span>
<span id="cb19-16"><a href="#cb19-16" tabindex="-1"></a><span class="co">#    pr_odds = 1000,</span></span>
<span id="cb19-17"><a href="#cb19-17" tabindex="-1"></a><span class="co">#    bayescan.path = "bayescan/BayeScan2.1_linux64bits"</span></span>
<span id="cb19-18"><a href="#cb19-18" tabindex="-1"></a><span class="co">#    )</span></span></code></pre></div>
<p>Print table</p>
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" tabindex="-1"></a><span class="co"># prepare dataframe with basic stats</span></span>
<span id="cb20-2"><a href="#cb20-2" tabindex="-1"></a>table_basic_stats<span class="ot">&lt;-</span><span class="fu">data.frame</span>(<span class="fu">unlist</span>(individuals_per_pop), <span class="fu">unlist</span>(nb_loci), <span class="fu">unlist</span>(polymoprhic_loci), <span class="fu">unlist</span>(Hs), <span class="fu">unlist</span>(Fis), <span class="fu">unlist</span>(ave_pairwise_fst), <span class="fu">unlist</span>(pop_specific_fst), <span class="at">row.names =</span> <span class="cn">NULL</span>)</span>
<span id="cb20-3"><a href="#cb20-3" tabindex="-1"></a><span class="fu">names</span> (table_basic_stats) <span class="ot">=</span> <span class="fu">c</span>(<span class="st">"GCU"</span>, <span class="st">"N"</span>, <span class="st">"nb_loci"</span>, <span class="st">"polymorphic_loci"</span>, <span class="st">"Hs"</span>, <span class="st">"Fis"</span>, <span class="st">"ave_pairwise_fst"</span>, <span class="st">"pop_specific_fst"</span>)</span>
<span id="cb20-4"><a href="#cb20-4" tabindex="-1"></a></span>
<span id="cb20-5"><a href="#cb20-5" tabindex="-1"></a><span class="co"># merge dataframes in a single table</span></span>
<span id="cb20-6"><a href="#cb20-6" tabindex="-1"></a>table_results <span class="ot">&lt;-</span> <span class="fu">merge</span>(table_basic_stats, q_by_pop, <span class="at">by.x =</span> <span class="st">"GCU"</span>, <span class="at">by.y =</span> <span class="st">"Group.1"</span>) <span class="co"># merge dataframes by GCU name, it orders the new dataframe alphabetically</span></span>
<span id="cb20-7"><a href="#cb20-7" tabindex="-1"></a><span class="fu">write.csv</span>(table_results,<span class="st">"table_results_Aalba_20SNPs.csv"</span>) <span class="co">#change species name</span></span></code></pre></div>



</body></html>